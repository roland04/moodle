{"version":3,"file":"mdl-78290.min.js","sources":["../src/mdl-78290.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * mdl-78290 Test\n *\n * @module      core/mdl-78290\n * @copyright   2023 Mikel Mart√≠n <mikel@moodle.com>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\n\nconst Selectors = {\n  DROPDOWN: '.dropdown',\n  DROPDOWN_SUBMENU: '.dropdown-submenu',\n  DROPDOWN_SUBMENU_ITEM: '.dropdown-submenu > .dropdown-item',\n  DROPDOWN_SUBMENU_MENU: '.dropdown-submenu > .dropdown-menu',\n};\n\n/**\n * Set the visibility of a submenu.\n *\n * @private\n * @param {HTMLElement} dropdownSubmenu The submenu to set the visibility.\n * @param {boolean} visible True to show the submenu, false to hide it.\n */\nconst _setSubmenuVisibility = (dropdownSubmenu, visible) => {\n  const dropdownSubmenuItem = dropdownSubmenu.querySelector(Selectors.DROPDOWN_SUBMENU_ITEM);\n  const dropdownSubmenuMenu = dropdownSubmenu.querySelector(Selectors.DROPDOWN_SUBMENU_MENU);\n  dropdownSubmenuItem.setAttribute('aria-expanded', visible ? 'true' : 'false');\n  dropdownSubmenuMenu.classList.toggle('show', visible);\n};\n\nlet initialized = false;\n\n/**\n * Initialise module for given report\n *\n * @method\n */\nexport const init = () => {\n\n    if (initialized) {\n        // We already added the event listeners (can be called multiple times by mustache template).\n        return;\n    }\n\n    // Add event listeners to submenus.\n    document.querySelectorAll(Selectors.DROPDOWN).forEach(dropdown => {\n      dropdown.addEventListener('click', event => {\n        const dropdownSubmenuItem = event.target.closest(Selectors.DROPDOWN_SUBMENU_ITEM);\n        if (dropdownSubmenuItem) {\n          // Avoid dropdowns being closed after clicking a subemnu.\n          // This won't be needed with BS5 (data-bs-auto-close handles it).\n          event.stopPropagation();\n\n          // Hide all visible submenus in the same dropdown first.\n          dropdown.querySelectorAll(`${Selectors.DROPDOWN_SUBMENU_MENU}.show`).forEach(visibleSubmenuMenu => {\n            const dropdownSubmenu = visibleSubmenuMenu.closest(Selectors.DROPDOWN_SUBMENU);\n            _setSubmenuVisibility(dropdownSubmenu, false);\n          });\n\n          // Show the submenu of the clicked item.\n          const dropdownSubmenu = dropdownSubmenuItem.closest(Selectors.DROPDOWN_SUBMENU);\n          _setSubmenuVisibility(dropdownSubmenu, true);\n        }\n      });\n    });\n\n    // Hide all submenus when hidind a dropdown.\n    // This is using JQuery because of BS4 events. JQuery won't be needed with BS5.\n    $('.dropdown').on('hidden.bs.dropdown', event => {\n      event.target.querySelectorAll(Selectors.DROPDOWN_SUBMENU).forEach(dropdownSubmenu => {\n        _setSubmenuVisibility(dropdownSubmenu, false);\n      });\n    });\n\n    initialized = true;\n};\n"],"names":["Selectors","_setSubmenuVisibility","dropdownSubmenu","visible","dropdownSubmenuItem","querySelector","dropdownSubmenuMenu","setAttribute","classList","toggle","initialized","document","querySelectorAll","forEach","dropdown","addEventListener","event","target","closest","stopPropagation","visibleSubmenuMenu","on"],"mappings":";;;;;;;gJAyBMA,mBACM,YADNA,2BAEc,oBAFdA,gCAGmB,qCAHnBA,gCAImB,qCAUnBC,sBAAwB,CAACC,gBAAiBC,iBACxCC,oBAAsBF,gBAAgBG,cAAcL,iCACpDM,oBAAsBJ,gBAAgBG,cAAcL,iCAC1DI,oBAAoBG,aAAa,gBAAiBJ,QAAU,OAAS,SACrEG,oBAAoBE,UAAUC,OAAO,OAAQN,cAG3CO,aAAc,gBAOE,KAEZA,cAMJC,SAASC,iBAAiBZ,oBAAoBa,SAAQC,WACpDA,SAASC,iBAAiB,SAASC,cAC3BZ,oBAAsBY,MAAMC,OAAOC,QAAQlB,oCAC7CI,oBAAqB,CAGvBY,MAAMG,kBAGNL,SAASF,2BAAoBZ,0CAAwCa,SAAQO,2BACrElB,gBAAkBkB,mBAAmBF,QAAQlB,4BACnDC,sBAAsBC,iBAAiB,YAInCA,gBAAkBE,oBAAoBc,QAAQlB,4BACpDC,sBAAsBC,iBAAiB,8BAO3C,aAAamB,GAAG,sBAAsBL,QACtCA,MAAMC,OAAOL,iBAAiBZ,4BAA4Ba,SAAQX,kBAChED,sBAAsBC,iBAAiB,SAI3CQ,aAAc"}